@import _tools

%overlap
  content: ' '
  position: absolute
  z-index: $z--mid
  left: 0
  display: block
  width: 100%
  border-color: transparent

=olcolor($color)
  border-color: transparentize($color, 0.5)
  background-color: transparentize($color, 0.5)

section
  position: relative
  z-index: $z--base

._skew
  +stretch
  z-index: $z--under
  overflow: hidden
  box-sizing: content-box
  transform: skewY($angle--ban) scaleZ(1)
  // Having the scaleZ gives a nicer render
  border-bottom: 1px solid transparent
  // Prevents a rendering artefact

  > ._skewcorrect
    +stretch
    transform: skewY($angle--ban / -1)

  &.-oltop,
  &.-olbottom
    &::after
      @extend %overlap

  &.-oltop
    &::after
      top: 0

    &.-oldouble
      &::after
        border-top-width: $overlap-size / 2
        border-top-style: solid

  &.-olbottom
    &::after
      bottom: 0

    &.-oldouble
      &::after
        border-bottom-width: $overlap-size / 2
        border-bottom-style: solid

  &.-olsmall
    &::after
      height: $overlap-size / 2

  &.-olsingle
    &::after
      height: $overlap-size / 2

  &.-oldouble
    &::after
      height: $overlap-size

  &.-olblue
    &::after
      +olcolor($co--blue--md)

  &.-olbluedk
    &::after
      +olcolor($co--blue--dk)

  &.-olwhite
    &::after
      +olcolor($co--wt)

  &.-olgreen
    &::after
      +olcolor($co--green)

.-skewbottom,
.-skewtop,
.-skewboth
    // -1px bottom margins prevent any whitespace / jagged edges appearing as an artefact
    margin-top: -1px
    margin-bottom: -1px

.-skewnone
  // Ensures straight line without artefacts
  z-index: $z--mid

  + .-skewtop,
  + .-skewboth
    z-index: $z--top
    margin-top: calc(#{$angle_h_ratio / -2} - 1px)

.-skewbottom
  > ._skew
    top: $angle_h_ratio / -2
    padding-bottom: $angle_h_ratio / 2

    > ._skewcorrect
      top: $angle_h_ratio / 2

.-skewtop
  > ._skew
    top: 0
    padding-top: $angle_h_ratio / 2

    > ._skewcorrect
      top: $angle_h_ratio / -2

.-skewboth
  > ._skew
    > ._skewcorrect
      top: $angle_h_ratio / -2
      height: calc(100% + #{$angle_h_ratio})

@media screen and (min-width: $bp--mn)
  ._skew
    &.-olsingle
      &::after
        height: $overlap-size

    &.-oldouble
      &::after
        height: $overlap-size * 2

    &.-oltop
      &.-oldouble
        &::after
          border-top-width: $overlap-size

    &.-olbottom
      &.-oldouble
        &::after
          border-bottom-width: $overlap-size
